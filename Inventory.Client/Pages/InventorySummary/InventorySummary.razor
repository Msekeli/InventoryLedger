@page "/inventory"
@inject IInventoryServiceClient InventoryService

<h3 class="mt-3">Inventory Summary</h3>

@if (summary is null)
{
    <p>Loading...</p>
}
else
{
    <div class="card p-3 shadow-sm mb-3">
        <h5>Total Inventory Value: R @summary.TotalInventoryValue</h5>
        <h5>Total Items: @summary.Items.Count</h5>
        <h5>Low Stock Items: @summary.Items.Count(i => i.IsLowStock)</h5>
    </div>

    <div class="table-responsive shadow-sm">
        <table class="table table-striped align-middle">
            <thead class="table-light">
                <tr>
                    <th>SKU</th>
                    <th>Name</th>
                    <th>On Hand</th>
                    <th>Unit Price</th>
                    <th>Value</th>
                    <th>Low Threshold</th>
                </tr>
            </thead>

            <tbody>
            @foreach (var item in summary.Items)
            {
                <tr class="@(item.IsLowStock ? "table-danger" : "")">
                    <td>@item.SKU</td>
                    <td>@item.Name</td>
                    <td>@item.OnHand</td>
                    <td>R @item.UnitPrice</td>
                    <td>R @item.Value</td>
                    <td>@item.LowStockThreshold</td>
                </tr>
            }
            </tbody>
        </table>
    </div>
}

@code {
    private InventorySummaryDto? summary;

    protected override async Task OnInitializedAsync()
    {
        summary = await InventoryService.GetSummaryAsync();
    }
}
